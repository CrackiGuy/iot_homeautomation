-- phpMyAdmin SQL Dump
-- version 4.5.1
-- http://www.phpmyadmin.net
--
-- Host: 127.0.0.1
-- Generation Time: Apr 20, 2018 at 08:03 AM
-- Server version: 10.1.19-MariaDB
-- PHP Version: 5.6.28

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `homeautomation`
--

-- --------------------------------------------------------

--
-- Table structure for table `sensor`
--

CREATE TABLE `sensor` (
  `id` int(100) NOT NULL,
  `temp` float NOT NULL,
  `huma` float NOT NULL,
  `light` float NOT NULL,
  `flame` int(10) NOT NULL,
  `date_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `motion` int(10) NOT NULL,
  `water` int(10) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `sensor`
--

INSERT INTO `sensor` (`id`, `temp`, `huma`, `light`, `flame`, `date_time`, `motion`, `water`) VALUES
(1, 24, 51, 52, 765, '2018-02-01 02:48:22', 1, 20),
(2, 24, 51, 52, 974, '2018-02-01 02:48:35', 1, 20),
(3, 24, 51, 53, 974, '2018-02-01 02:48:39', 0, 20),
(4, 24, 51, 50, 968, '2018-02-01 02:48:56', 0, 20),
(5, 24, 51, 50, 968, '2018-02-01 02:49:01', 1, 20),
(6, 24, 51, 48, 968, '2018-02-01 02:49:06', 0, 20),
(7, 24, 51, 42, 967, '2018-02-01 02:49:12', 1, 20),
(8, 24, 52, 64, 724, '2018-02-01 02:50:15', 0, 20),
(9, 24, 52, 63, 771, '2018-02-01 02:50:21', 0, 20),
(10, 24, 52, 60, 751, '2018-02-01 02:50:40', 0, 20),
(11, 24, 52, 61, 772, '2018-02-01 02:50:47', 0, 20),
(12, 24, 52, 58, 965, '2018-02-01 02:51:08', 1, 20),
(13, 24, 52, 58, 967, '2018-02-01 02:51:13', 0, 20),
(14, 24, 52, 57, 966, '2018-02-01 02:51:50', 1, 20),
(15, 24, 52, 53, 966, '2018-02-01 02:51:55', 0, 20),
(16, 24, 52, 56, 964, '2018-02-01 02:52:02', 1, 20),
(17, 24, 52, 51, 54, '2018-02-01 02:52:16', 0, 20),
(18, 24, 52, 55, 968, '2018-02-01 02:52:21', 0, 20),
(19, 24, 53, 51, 972, '2018-02-01 02:52:28', 1, 20),
(20, 24, 52, 51, 974, '2018-02-01 02:52:32', 0, 20),
(21, 24, 53, 51, 974, '2018-02-01 02:52:37', 0, 20),
(22, 23, 53, 52, 974, '2018-02-01 02:52:42', 1, 20),
(23, 24, 53, 54, 973, '2018-02-01 02:52:47', 0, 20),
(24, 24, 53, 63, 922, '2018-02-01 02:53:18', 1, 20),
(25, 24, 52, 59, 739, '2018-02-01 02:54:07', 0, 20),
(26, 24, 52, 58, 903, '2018-02-01 02:54:14', 0, 20),
(27, 24, 52, 20, 765, '2018-02-01 02:54:33', 0, 20),
(28, 24, 51, 62, 959, '2018-02-01 02:54:39', 1, 20),
(29, 24, 51, 61, 53, '2018-02-01 02:54:52', 0, 20),
(30, 24, 51, 61, 975, '2018-02-01 02:54:58', 0, 20),
(31, 24, 51, 62, 973, '2018-02-01 02:55:22', 1, 20),
(32, 24, 51, 60, 874, '2018-02-01 02:56:04', 1, 20),
(33, 23, 52, 61, 967, '2018-02-01 03:16:25', 0, 20),
(34, 25, 58, 99, 1015, '2018-02-10 18:26:19', 0, 230),
(35, 24, 58, 99, 1013, '2018-02-10 18:26:30', 1, 230),
(36, 25, 58, 99, 1014, '2018-02-10 18:26:34', 1, 232),
(37, 25, 58, 99, 1010, '2018-02-10 18:26:40', 0, 230),
(38, 25, 58, 99, 1017, '2018-02-10 18:26:50', 0, 231),
(39, 25, 58, 100, 1020, '2018-02-10 18:26:53', 0, 230),
(40, 25, 58, 99, 1019, '2018-02-10 18:26:56', 0, 230),
(41, 25, 58, 99, 1016, '2018-02-10 18:26:59', 0, 231),
(42, 25, 58, 100, 1015, '2018-02-10 18:27:01', 0, 230),
(43, 25, 58, 99, 1014, '2018-02-10 18:27:04', 0, 231),
(44, 25, 58, 99, 1013, '2018-02-10 18:27:07', 0, 230),
(45, 25, 58, 99, 1012, '2018-02-10 18:27:10', 0, 230),
(46, 25, 58, 99, 1013, '2018-02-10 18:27:13', 0, 230),
(47, 25, 58, 99, 1015, '2018-02-10 18:27:16', 0, 231),
(48, 25, 58, 99, 1014, '2018-02-10 18:27:19', 0, 230),
(49, 25, 58, 100, 1017, '2018-02-10 18:27:22', 0, 230),
(50, 25, 58, 100, 1020, '2018-02-10 18:27:25', 0, 230),
(51, 25, 58, 100, 1023, '2018-02-10 18:27:28', 0, 230),
(52, 25, 58, 99, 1015, '2018-02-10 18:27:31', 0, 230),
(53, 25, 58, 99, 1014, '2018-02-10 18:27:34', 0, 230),
(54, 25, 58, 99, 1011, '2018-02-10 18:27:37', 0, 230),
(55, 25, 58, 100, 1017, '2018-02-10 18:27:40', 0, 232),
(56, 25, 58, 99, 1012, '2018-02-10 18:27:43', 0, 231),
(57, 25, 58, 99, 1014, '2018-02-10 18:27:46', 0, 230),
(58, 25, 58, 99, 1021, '2018-02-10 18:27:49', 0, 230),
(59, 25, 58, 100, 1015, '2018-02-10 18:27:52', 0, 230),
(60, 25, 58, 99, 1013, '2018-02-10 18:27:55', 0, 230),
(61, 25, 58, 99, 1019, '2018-02-10 18:27:58', 0, 230),
(62, 25, 58, 99, 1020, '2018-02-10 18:28:00', 0, 230),
(63, 25, 58, 99, 1014, '2018-02-10 18:28:03', 0, 230),
(64, 25, 58, 99, 1017, '2018-02-10 18:28:06', 0, 233),
(65, 25, 58, 100, 1016, '2018-02-10 18:28:09', 0, 230),
(66, 25, 58, 99, 1012, '2018-02-10 18:28:12', 0, 230),
(67, 25, 58, 99, 1016, '2018-02-10 18:28:15', 0, 230),
(68, 25, 58, 99, 1017, '2018-02-10 18:28:19', 0, 230),
(69, 25, 58, 98, 1010, '2018-02-10 18:28:22', 0, 230),
(70, 25, 58, 100, 1020, '2018-02-10 18:28:25', 0, 231),
(71, 25, 58, 99, 1014, '2018-02-10 18:28:27', 0, 231),
(72, 25, 58, 99, 1014, '2018-02-10 18:28:30', 0, 231),
(73, 25, 58, 99, 1015, '2018-02-10 18:28:33', 0, 230),
(74, 25, 58, 99, 1013, '2018-02-10 18:28:36', 0, 231),
(75, 25, 58, 99, 1015, '2018-02-10 18:28:41', 1, 234),
(76, 25, 58, 99, 1016, '2018-02-10 18:28:44', 0, 230),
(77, 25, 57, 99, 1010, '2018-02-10 18:28:47', 0, 230),
(78, 25, 58, 99, 1014, '2018-02-10 18:28:50', 0, 230),
(79, 25, 58, 99, 1017, '2018-02-10 18:28:53', 0, 232),
(80, 25, 58, 99, 1018, '2018-02-10 18:28:56', 0, 230),
(81, 25, 58, 99, 1018, '2018-02-10 18:28:59', 0, 230),
(82, 25, 58, 99, 1011, '2018-02-10 18:29:02', 0, 232),
(83, 25, 58, 100, 1015, '2018-02-10 18:29:05', 0, 231),
(84, 25, 58, 99, 1014, '2018-02-10 18:29:08', 0, 230),
(85, 25, 58, 99, 1017, '2018-02-10 18:29:11', 0, 230),
(86, 25, 58, 100, 1016, '2018-02-10 18:29:14', 0, 231),
(87, 25, 58, 99, 1014, '2018-02-10 18:29:17', 0, 231),
(88, 25, 58, 100, 1015, '2018-02-10 18:29:20', 0, 230),
(89, 25, 58, 99, 1012, '2018-02-10 18:29:23', 0, 230),
(90, 25, 58, 98, 1012, '2018-02-10 18:29:26', 0, 230),
(91, 25, 58, 100, 1016, '2018-02-10 18:29:29', 0, 230),
(92, 25, 58, 99, 1013, '2018-02-10 18:29:31', 0, 231),
(93, 25, 58, 100, 1021, '2018-02-10 18:29:34', 0, 231),
(94, 25, 58, 99, 1017, '2018-02-10 18:29:37', 0, 231),
(95, 25, 58, 99, 1015, '2018-02-10 18:29:42', 1, 232),
(96, 25, 58, 69, 1013, '2018-02-10 18:29:45', 0, 230),
(97, 25, 58, 100, 1016, '2018-02-10 18:29:48', 0, 230),
(98, 25, 58, 84, 1012, '2018-02-10 18:29:51', 0, 230),
(99, 25, 58, 100, 1011, '2018-02-10 18:29:54', 0, 230),
(100, 25, 58, 100, 1019, '2018-02-10 18:29:57', 0, 230),
(101, 25, 58, 3, 1013, '2018-02-10 18:30:00', 0, 230),
(102, 25, 58, 100, 1020, '2018-02-10 18:30:10', 1, 232),
(103, 25, 57, 99, 1017, '2018-02-10 18:30:13', 0, 231),
(104, 25, 58, 100, 1014, '2018-02-10 18:30:15', 0, 231),
(105, 25, 58, 100, 1020, '2018-02-10 18:30:18', 0, 230),
(106, 25, 58, 99, 1021, '2018-02-10 18:30:21', 0, 231),
(107, 25, 58, 99, 1019, '2018-02-10 18:30:24', 0, 230),
(108, 25, 58, 99, 1020, '2018-02-10 18:30:27', 0, 231),
(109, 25, 58, 99, 1015, '2018-02-10 18:30:30', 0, 231),
(110, 25, 58, 99, 1017, '2018-02-10 18:30:33', 0, 230),
(111, 25, 58, 99, 1017, '2018-02-10 18:30:36', 0, 230),
(112, 25, 58, 99, 1013, '2018-02-10 18:30:39', 0, 231),
(113, 25, 58, 99, 1012, '2018-02-10 18:30:42', 0, 231),
(114, 25, 58, 99, 1017, '2018-02-10 18:30:45', 0, 231),
(115, 25, 58, 99, 1014, '2018-02-10 18:30:48', 0, 231),
(116, 25, 58, 99, 1017, '2018-02-10 18:30:51', 0, 230),
(117, 25, 58, 99, 1016, '2018-02-10 18:30:54', 0, 230),
(118, 25, 58, 99, 1015, '2018-02-10 18:30:57', 0, 230),
(119, 25, 58, 99, 1013, '2018-02-10 18:31:00', 0, 230),
(120, 25, 58, 99, 1010, '2018-02-10 18:31:03', 0, 230),
(121, 25, 58, 99, 1015, '2018-02-10 18:31:06', 0, 230),
(122, 25, 58, 99, 1014, '2018-02-10 18:31:08', 0, 230),
(123, 25, 58, 99, 1012, '2018-02-10 18:31:11', 0, 230),
(124, 25, 58, 99, 1015, '2018-02-10 18:31:14', 0, 230),
(125, 25, 58, 100, 1016, '2018-02-10 18:31:17', 0, 231),
(126, 25, 58, 99, 1018, '2018-02-10 18:31:20', 0, 231),
(127, 25, 58, 100, 1014, '2018-02-10 18:31:23', 0, 231),
(128, 25, 58, 100, 1012, '2018-02-10 18:31:26', 0, 230),
(129, 25, 58, 99, 1012, '2018-02-10 18:31:29', 0, 230),
(130, 25, 58, 99, 1014, '2018-02-10 18:31:32', 0, 231),
(131, 25, 58, 99, 1016, '2018-02-10 18:31:35', 0, 230),
(132, 25, 58, 99, 1016, '2018-02-10 18:31:38', 0, 231);

-- --------------------------------------------------------

--
-- Table structure for table `user`
--

CREATE TABLE `user` (
  `id` int(11) NOT NULL,
  `user` varchar(100) NOT NULL,
  `passwd` varchar(100) NOT NULL,
  `email` varchar(200) NOT NULL,
  `name` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `user`
--

INSERT INTO `user` (`id`, `user`, `passwd`, `email`, `name`) VALUES
(1, 'cracki', 'naylinaung', 'naylinaung.nla.xo@gmail.com', 'Nay Lin Aung'),
(2, 'noob', 'noon', 'noob@gmail.com', 'noobKg'),
(3, 'ggwp', 'ggwp', 'ggwp', 'ggwp');

-- --------------------------------------------------------

--
-- Table structure for table `water`
--

CREATE TABLE `water` (
  `name` varchar(100) NOT NULL,
  `value` int(10) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `water`
--

INSERT INTO `water` (`name`, `value`) VALUES
('water', 400);

--
-- Indexes for dumped tables
--

--
-- Indexes for table `sensor`
--
ALTER TABLE `sensor`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `user`
--
ALTER TABLE `user`
  ADD PRIMARY KEY (`id`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `sensor`
--
ALTER TABLE `sensor`
  MODIFY `id` int(100) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=133;
--
-- AUTO_INCREMENT for table `user`
--
ALTER TABLE `user`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;
DELIMITER $$
--
-- Events
--
CREATE DEFINER=`root`@`localhost` EVENT `my_event` ON SCHEDULE EVERY 1 MINUTE STARTS '2018-02-12 01:26:37' ON COMPLETION NOT PRESERVE ENABLE DO BEGIN
			SET @OUTFILE = 
			   CONCAT (
				   "SELECT * FROM `sensor` into outfile '/xampp/htdocs/iot/log/data-"
				   , DATE_FORMAT( NOW(), '%Y-%m-%d-%h-%i')
				   , ".csv'"
				   ,"FIELDS TERMINATED BY ','"
				   ,"ENCLOSED BY '""'"
				   ,"LINES TERMINATED BY '\n'"
				);
            PREPARE s1 FROM @OUTFILE;
			EXECUTE s1;
            DROP PREPARE s1;
            DELETE FROM sensor;
	END$$

DELIMITER ;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
